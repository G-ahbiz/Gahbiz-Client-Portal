<nav class="navbar navbar-expand-xl px-2 px-sm-3 px-lg-4 p-xl-5 z-5000">
  <div class="container-fluid d-flex justify-content-between align-items-center p-0">

    <!-- Logo -->
    <a class="navbar-brand logo-container" href="#">
      <img src="assets/images/logo/logo.png" alt="Logo" class="main-logo">
    </a>

    <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
      aria-controls="offcanvasNavbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="offcanvas" [class]="isArabic ? 'offcanvas-end' : 'offcanvas-start'" tabindex="-1" id="offcanvasNavbar"
      aria-labelledby="offcanvasNavbarLabel">

      <div class="offcanvas-header p-3 p-md-4">
        <div class="offcanvas-logo-container">
          <img src="assets/images/logo/logo.png" alt="Logo" class="offcanvas-logo">
        </div>
        <button type="button" class="btn-close text-reset p-3" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>

      <div class="offcanvas-body">
        <!-- Adjusted to shift navigation left -->
        <div
          class="container-fluid p-0 m-0 d-flex flex-column flex-xl-row align-items-xl-center gap-3 gap-xl-0 position-relative">

          <!-- Navigation shifted left with margin -->
          <ul class="navbar-nav mb-2 mb-lg-0 gap-3 gap-xl-4 flex-xl-grow-1 navigation-center" [class.cairo]="isArabic"
            [class.gap-2]="isSpanish" [class.text-nowrap]="isSpanish">
            <li class="nav-item">
              <a class="nav-link fw-medium orange-hover fs-6 px-2 px-xl-3 py-2" routerLink="/home">{{'navbar.home' |
                translate}}</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle fw-medium orange-hover services-dropdown-toggle fs-6 px-2 px-xl-3 py-2"
                href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                {{'navbar.services' | translate}}
              </a>
              <ul class="dropdown-menu dropdown-menu-end services-dropdown py-2" aria-labelledby="navbarDropdown">
                @for (service of services; track service.id) {
                <li>
                  <a class="dropdown-item px-3 py-2" href="javascript:void(0)"
                    (click)="setActiveServiceList(service.id)">{{
                    isArabic ? service.serviceAr : isEnglish ? service.serviceEn :
                    service.serviceSp }}</a>
                </li>
                }
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link fw-medium orange-hover fs-6 px-2 px-xl-3 py-2" routerLink="/about">{{'navbar.about' |
                translate}}</a>
            </li>
            <li class="nav-item">
              <a class="nav-link fw-medium orange-hover fs-6 px-2 px-xl-3 py-2" routerLink="/faq">{{'navbar.faq' |
                translate}}</a>
            </li>
            <li class="nav-item">
              <a class="nav-link fw-medium orange-hover fs-6 px-2 px-xl-3 py-2" routerLink="/contact">{{'navbar.contact'
                | translate}}</a>
            </li>
            <li class="nav-item">
              <a class="nav-link fw-medium orange-hover fs-6 px-2 px-xl-3 py-2" routerLink="/search"><i
                  class="pi pi-search fs-6"></i></a>
            </li>
          </ul>

          <!-- Actions positioned with proper spacing -->
          <div class="d-flex justify-content-start align-items-center gap-3 gap-xl-4 navbar-actions"
            [class.cairo]="isArabic" [class.gap-2]="isSpanish" [class.text-nowrap]="isSpanish">

            <div class="btn-group language-btn-group">
              <button type="button" class="btn gap-2 d-flex align-items-center outline-0 p-2" data-bs-toggle="dropdown"
                aria-expanded="false" [title]="isEnglish ? 'English' : isArabic ? 'عربي' : isSpanish ? 'Español' : ''">
                <i class="pi pi-globe fs-6"></i>
              </button>

              <ul class="dropdown-menu language-dropdown py-2">
                <li>
                  <a class="dropdown-item d-flex align-items-center gap-2 px-3 py-2" href="javascript:void(0)"
                    (click)="changeLanguage('en')">
                    <img src="assets/images/navbar/language-icons/america.svg" alt="" class="flag-icon">
                    <span class="">{{'navbar.english' | translate}}</span>
                  </a>
                </li>
                <li>
                  <a class="dropdown-item d-flex align-items-center gap-2 px-3 py-2" href="javascript:void(0)"
                    (click)="changeLanguage('ar')">
                    <img src="assets/images/navbar/language-icons/egypt.svg" alt="" class="flag-icon">
                    <span class="">{{'navbar.arabic' | translate}}</span>
                  </a>
                </li>
                <li>
                  <a class="dropdown-item d-flex align-items-center gap-2 px-3 py-2" href="javascript:void(0)"
                    (click)="changeLanguage('sp')">
                    <img src="assets/images/navbar/language-icons/spain.svg" alt="" class="flag-icon">
                    <span class="">{{'navbar.spanish' | translate}}</span>
                  </a>
                </li>
              </ul>
            </div>

            @if (isLoggedIn$ | async) {
            <div class="d-flex align-items-center gap-2 gap-xl-3 profile-section">
              <a routerLink="/cart" class="nav-link cart-icon-container p-2">
                <i class="pi pi-shopping-bag icons"></i>
                @if (cartItemCount > 0) {
                <span class="cart-badge">{{ cartItemCount }}</span>
                }
              </a>

              <div class="dropdown">
                <a class="nav-link profile-link dropdown-toggle d-flex align-items-center p-2" href="#" role="button"
                  data-bs-toggle="dropdown" aria-expanded="false" id="profileDropdown">
                  @if ((currentUser$ | async); as user) {
                  @if (user.profileImageUrl) {
                  <img [src]="user.profileImageUrl" alt="Profile" class="profile-pic-circle">
                  } @else {
                  <i class="pi pi-user icons"></i>
                  }
                  }
                </a>

                <ul class="dropdown-menu dropdown-menu-end py-2" aria-labelledby="profileDropdown">
                  <li>
                    <a class="dropdown-item d-flex align-items-center px-3 py-2" routerLink="/complete-profile">
                      <i class="pi pi-user-edit me-2"></i>
                      {{'navbar.profile' | translate}}
                    </a>
                  </li>
                  <li>
                    <hr class="dropdown-divider my-2">
                  </li>
                  <li>
                    <a class="dropdown-item d-flex align-items-center px-3 py-2" routerLink="/wishlist">
                      <i class="pi pi-heart me-2"></i>
                      {{'navbar.wishlist' | translate}}
                    </a>
                  </li>
                  <li>
                    <hr class="dropdown-divider my-2">
                  </li>
                  <li>
                    <button class="dropdown-item d-flex align-items-center text-danger px-3 py-2" (click)="logout()">
                      <i class="pi pi-sign-out me-2"></i>
                      {{'navbar.logout' | translate}}
                    </button>
                  </li>
                </ul>
              </div>
            </div>
            } @else {
            <a class="nav-link fw-normal primary-clr fs-6 px-2 px-xl-3 py-2" routerLink="/auth/sign-in">
              {{'navbar.login' | translate}}
            </a>
            }

            <button type="button" class="btn btn-primary primary-bg fw-normal fs-6 px-3 px-xl-4 py-2 book-service-btn"
              routerLink="/appointment-service">
              {{'navbar.bookaservice' | translate}}</button>
          </div>
        </div>

      </div>
    </div>
  </div>
</nav>