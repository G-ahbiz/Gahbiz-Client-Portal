<div class="container-fluid px-1 py-4 p-lg-5 our-services">
  <div class="our-services-header w-100 d-flex flex-column justify-content-center align-items-center text-center mb-4">
    <p class="our-services-subtitle txt-clr mb-1">
      {{ 'our-services.subtitle' | translate }}
    </p>
    <h1 class="our-services-title fw-medium">
      <span class="txt-clr">{{ 'our-services.title1' | translate }}</span>
      <span class="text-highlight">{{ 'our-services.title2' | translate }}</span>
    </h1>
    <div class="decoration-underline d-flex justify-content-between align-content-center">
      <div class="h-100 orange-bg-clr w-50"></div>
      <div class="h-100 white-bg-clr w-50"></div>
    </div>
  </div>

  @if (isLoading) {
  <div class="slider-loading">
    <div class="spinner"></div>
  </div>
  }

  @if (!isLoading && services.length === 0) {
  <div class="slider-empty txt-clr text-center">
    <p class="fs-5 mb-4">{{ 'our-services.noServices' | translate }}</p>

    <button class="btn explore-button orange-bg-clr d-flex justify-content-center align-items-center gap-3 px-5 py-3"
      (click)="retryLoadServices()">
      <span class="fw-semibold fs-6 text-nowrap">{{ 'our-services.tryAgain' | translate }}</span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
        <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
      </svg>
    </button>
  </div>
  }

  @if (!isLoading && services.length > 0) {
  <div class="our-slider">
    <div class="slider-viewport mx-auto" tabindex="0" (keydown.arrowleft)="navigatePrev()"
      (keydown.arrowright)="navigateNext()" (touchstart)="onTouchStart($event)" (touchend)="onTouchEnd($event)"
      (focusin)="stopAutoplay()" (focusout)="startAutoplay()" role="list" aria-label="Our services slider">
      @for (s of services; track s.category; let i = $index) {
      <div class="slide" [ngStyle]="getSlideStyle(i)" [class.slide-active]="i === currentIndex" [attr.data-index]="i"
        (click)="onServiceClick(s)" role="listitem">
        <div class="image-wrapper">
          <img [src]="s.image" [alt]="s.title" class="slide-image" />
        </div>

        <div class="details-card">
          <div class="details-left">
            <div class="service-title">{{ s.title }}
              <span class="service-count">
                (has {{ s.serviceCount }}
                {{ s.serviceCount === 1 ? ('Service' | translate) : ('Services' | translate) }})
              </span>
            </div>
            <div class="service-caption">{{ s.caption }}</div>
          </div>

          <div class="details-action" aria-hidden="true">
            <div class="arrow-round" [attr.aria-label]="'open ' + s.title">
              @if (!isArabic) {
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M10 6L16 12L10 18" stroke="#005db5" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
              } @else {
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M14 6L8 12L14 18" stroke="#005db5" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
              }
            </div>
          </div>
        </div>
      </div>
      }
    </div>

    <div class="slider-controls d-flex justify-content-between align-items-center">
      <button class="ctrl prev btn" (click)="navigatePrev()" aria-label="Previous slide" (mouseenter)="stopAutoplay()"
        (mouseleave)="startAutoplay()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M15 18L9 12L15 6" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>

      <button class="ctrl next btn" (click)="navigateNext()" aria-label="Next slide" (mouseenter)="stopAutoplay()"
        (mouseleave)="startAutoplay()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M9 6L15 12L9 18" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
    </div>
  </div>
  }

  @if (!isLoading && services.length > 0) {
  <div class="explore-button-container w-100 d-flex justify-content-center align-items-center mt-5">
    <button class="btn explore-button orange-bg-clr d-flex justify-content-center align-items-center gap-3 px-5 py-3"
      (click)="navigateToAllServices()">
      <span class="fw-semibold fs-6 text-nowrap">{{ 'our-services.explore' | translate }}</span>
      @if (!isArabic) {
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <path d="M10 6L16 12L10 18" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
      } @else {
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <path d="M14 6L8 12L14 18" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
      }
    </button>
  </div>
  }
</div>